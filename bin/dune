(ocamllex lexer)

(menhir
 (modules parser))

(library
 (name basictypes)
 (modules basictypes)
 (preprocess
  (pps ppx_deriving.show)))


(library
  (name lexer)
  (libraries parser)
  (modules lexer))

(library
  (name parser)
  (libraries pirouette basictypes)
  (modules parser))

(library
  (name utils)
  (libraries unix)
  (modules utils))

(library
 (name constants)
 (modules constants))

(executable
 (name main)
 (public_name main)
 (modules main)
 (libraries pirouette parser unix lexer threads.posix stdune))



(executable
 (name output)
 (public_name output)
 (modules output)
 (libraries threads.posix stdune))

(library
 (name pirouette)
 (modules pirouette)
 (libraries basictypes)
 (preprocess
  (pps ppx_deriving.show)))

(library
 (name controlang)
 (modules controlang)
 (libraries basictypes pirouette)
 (preprocess
  (pps ppx_deriving.show)))


(library
 (name backend_intf)
 (modules backend_intf)
 (libraries controlang)
 )

(library
 (name ocaml_backend)
 (modules ocaml_backend)
 (libraries backend_intf constants controlang basictypes)
 )


(executable
 (name exec)
 (public_name exec)
 (modules exec)
 (libraries ocaml_backend backend_intf utils))
